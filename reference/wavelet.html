<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>'Morlet' wavelet transform (Discrete) — wavelet • ravetools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="'Morlet' wavelet transform (Discrete) — wavelet"><meta property="og:description" content="Transform analog voltage signals with 'Morlet'
wavelets: complex wavelet kernels with \(\pi/2\) phase
differences."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ravetools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dipterix/ravetools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>'Morlet' wavelet transform (Discrete)</h1>
    <small class="dont-index">Source: <a href="https://github.com/dipterix/ravetools/blob/HEAD/R/wavelet.R" class="external-link"><code>R/wavelet.R</code></a></small>
    <div class="hidden name"><code>wavelet.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Transform analog voltage signals with 'Morlet'
wavelets: complex wavelet kernels with \(\pi/2\) phase
differences.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">wavelet_kernels</span><span class="op">(</span><span class="va">freqs</span>, <span class="va">srate</span>, <span class="va">wave_num</span><span class="op">)</span>

<span class="fu">morlet_wavelet</span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">freqs</span>,
  <span class="va">srate</span>,
  <span class="va">wave_num</span>,
  precision <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"float"</span>, <span class="st">"double"</span><span class="op">)</span>,
  trend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"constant"</span>, <span class="st">"linear"</span>, <span class="st">"none"</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>freqs</dt>
<dd><p>frequency in which <code>data</code> will be projected on</p></dd>
<dt>srate</dt>
<dd><p>sample rate, number of time points per second</p></dd>
<dt>wave_num</dt>
<dd><p>desired number of cycles in wavelet kernels to
balance the precision in time and amplitude (control the
smoothness); positive integers are strongly suggested</p></dd>
<dt>data</dt>
<dd><p>numerical vector such as analog voltage signals</p></dd>
<dt>precision</dt>
<dd><p>the precision of computation; choices are
<code>'float'</code> (default) and <code>'double'</code>.</p></dd>
<dt>trend</dt>
<dd><p>choices are <code>'constant'</code>: center the signal at zero;
<code>'linear'</code>: remove the linear trend; <code>'none'</code> do nothing</p></dd>
<dt>...</dt>
<dd><p>further passed to <code><a href="detrend.html">detrend</a></code>;</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>wavelet_kernels</code> returns wavelet kernels to be
used for wavelet function; <code>morlet_wavelet</code> returns a file-based array
if <code>precision</code> is <code>'float'</code>, or a list of real and imaginary
arrays if <code>precision</code> is <code>'double'</code></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># generate sine waves</span></span>
<span class="r-in"><span class="va">time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">time</span> <span class="op">*</span> <span class="fl">20</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">time</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">time</span> <span class="op">*</span> <span class="fl">10</span><span class="op">*</span><span class="va">pi</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">x</span>, type <span class="op">=</span> <span class="st">'l'</span><span class="op">)</span></span>
<span class="r-plt img"><img src="wavelet-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># freq from 1 - 15 Hz; wavelet using float precision</span></span>
<span class="r-in"><span class="va">freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu">morlet_wavelet</span><span class="op">(</span><span class="va">x</span>, <span class="va">freq</span>, <span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># to get coefficients in complex number from 1-10 time points</span></span>
<span class="r-in"><span class="va">coef</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        [,1]                  [,2]                  [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.0794150+0.1186043i  0.0906856+0.1566062i  0.0814917+0.2158995i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.0700359+0.1221303i  0.0750028+0.1634681i  0.0539018+0.2204804i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.0602830+0.1248344i  0.0599490+0.1687918i  0.0288821+0.2217750i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.0503087+0.1270776i  0.0456197+0.1722808i  0.0064653+0.2200116i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.0403200+0.1290842i  0.0317036+0.1737074i -0.0142149+0.2154187i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.0305118+0.1308505i  0.0176536+0.1729923i -0.0344019+0.2081803i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.0210032+0.1321430i  0.0029537+0.1702363i -0.0550644+0.1984321i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.0118025+0.1325862i -0.0126194+0.1656932i -0.0763701+0.1862965i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.0028159+0.1318068i -0.0288422+0.1596938i -0.0974905+0.1719405i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.0061006+0.1295805i -0.0450556+0.1525505i -0.1168152+0.1556303i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        [,4]                  [,5]                  [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.0949489+0.2750027i  0.0783175+0.3720973i  0.1220748+0.4939324i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.0575082+0.2820133i  0.0206677+0.3739292i  0.0279760+0.5025347i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.0213738+0.2835686i -0.0383902+0.3655892i -0.0633814+0.4926330i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.0127264+0.2795582i -0.0963134+0.3473318i -0.1478229+0.4650585i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.0446278+0.2700548i -0.1497941+0.3199039i -0.2225149+0.4214858i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.0745211+0.2553693i -0.1954383+0.2845643i -0.2857609+0.3642318i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.1026240+0.2360650i -0.2305676+0.2430175i -0.3364932+0.2960882i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.1288635+0.2129196i -0.2538596+0.1972672i -0.3737223+0.2202145i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.1526974+0.1868443i -0.2655950+0.1494193i -0.3962145+0.1400774i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.1731465+0.1587818i -0.2674233+0.1014823i -0.4025613+0.0593922i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        [,7]                  [,8]                  [,9]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.1230748+0.6599417i  0.2951221+0.8054119i  0.4819089+0.9416207i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -0.0091557+0.6693053i  0.1144831+0.8629214i  0.2564272+1.0539577i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -0.1451654+0.6481661i -0.0766695+0.8763458i  0.0038488+1.1080878i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.2769141+0.5966316i -0.2670650+0.8425891i -0.2598002+1.0963969i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.3954057+0.5168822i -0.4454252+0.7617195i -0.5169657+1.0158346i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.4918997+0.4131744i -0.6010166+0.6371825i -0.7497137+0.8684299i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.5592617+0.2916004i -0.7240908+0.4757478i -0.9408802+0.6614633i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.5930797+0.1596200i -0.8063275+0.2871702i -1.0752515+0.4072578i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.5922410+0.0254319i -0.8413823+0.0835719i -1.1407989+0.1225601i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.5588400-0.1027219i -0.8255584-0.1214194i -1.1299268-0.1725127i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,10]               [,11]               [,12]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.613102+1.113441i  0.976351+1.053078i  1.224933+1.016077i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.334765+1.270981i  0.707273+1.322740i  0.957780+1.370941i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.009572+1.352579i  0.356807+1.517699i  0.583224+1.650954i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.339798+1.344911i -0.052616+1.612706i  0.124491+1.820881i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.685792+1.241515i -0.489962+1.589770i -0.384464+1.853221i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.998754+1.044071i -0.918246+1.440890i -0.901349+1.732111i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.250209+0.762883i -1.298234+1.169810i -1.379048+1.456176i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -1.416096+0.416464i -1.592688+0.792525i -1.770071+1.039913i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -1.479472+0.030223i -1.770584+0.336391i -2.031606+0.513284i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.432301-0.365627i -1.810719-0.162099i -2.130622-0.080518i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,13]               [,14]               [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.351917+1.109238i  1.643858+0.738275i  1.783807+0.880918i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  1.051716+1.520337i  1.461398+1.252411i  1.547634+1.462459i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.621860+1.843234i  1.107498+1.715625i  1.106543+1.968655i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.090727+2.033931i  0.599450+2.067658i  0.490108+2.325875i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.499234+2.058647i -0.023976+2.255274i -0.244209+2.473842i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.094879+1.898954i -0.705734+2.240352i -1.018216+2.375775i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.637363+1.555324i -1.376605+2.006246i -1.743800+2.024881i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.068358+1.048521i -1.963365+1.561350i -2.335266+1.446105i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.336840+0.418518i -2.397860+0.939262i -2.720973+0.693061i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -2.405631-0.279020i -2.625656+0.195567i -2.852357-0.159018i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,16]               [,17]               [,18]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.000951+0.432982i  2.102120+0.208268i  2.199623-0.012338i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  1.917492+1.105536i  2.097086+0.946076i  2.272068+0.796165i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  1.585154+1.752697i  1.806360+1.684411i  2.016837+1.630613i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.017395+2.279918i  1.236871+2.307826i  1.435630+2.350384i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.266702+2.602245i  0.445330+2.710774i  0.592953+2.826527i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.582713+2.659491i -0.471010+2.818242i -0.396267+2.969173i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.428391+2.426826i -1.392163+2.599708i -1.390510+2.745224i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.166105+1.918741i -2.197121+2.073499i -2.250213+2.182299i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.705689+1.186064i -2.784126+1.301320i -2.863374+1.359051i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -2.983122+0.307307i -3.085053+0.375278i -3.162112+0.385846i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,19]               [,20]               [,21]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.335065+0.692462i  2.450125+0.064544i  2.465200-0.200895i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.130339+1.470700i  2.458672+0.905802i  2.567991+0.677207i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  1.656247+2.176444i  2.161388+1.745927i  2.336926+1.586128i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.942572+2.713952i  1.564769+2.470893i  1.769257+2.394769i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.053698+3.001242i  0.720175+2.973698i  0.916640+2.977841i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.918137+2.982621i -0.282009+3.171480i -0.121858+3.237772i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.864025+2.637825i -1.324938+3.018955i -1.215720+3.121441i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.672283+1.986269i -2.282112+2.515803i -2.224221+2.628534i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.242959+1.085815i -3.035234+1.707008i -3.018299+1.810430i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -3.500812+0.026294i -3.490049+0.676527i -3.498771+0.760729i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,22]               [,23]               [,24]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.471910-0.452744i  2.483108-0.698118i  2.509566-0.942330i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.666216+0.464194i  2.768122+0.265674i  2.885418+0.081284i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  2.495334+1.443684i  2.650262+1.323497i  2.811707+1.229427i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.947960+2.334120i  2.110796+2.298310i  2.264235+2.293649i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  1.078676+2.989411i  1.211069+3.019752i  1.316313+3.075509i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.001040+3.296944i  0.080254+3.359739i  0.121468+3.431473i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.143532+3.198129i -1.112046+3.257323i -1.123057+3.302408i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.192038+2.697227i -2.190565+2.727210i -2.220986+2.720541i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.007503+1.857451i -3.007271+1.851197i -3.017137+1.793888i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -3.489274+0.786568i -3.464517+0.756580i -3.422676+0.674776i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,25]               [,26]               [,27]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.559719-1.187120i  2.638785-1.430457i  3.014868-1.106089i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  3.025685-0.087531i  3.191604-0.237921i  3.387802+0.294407i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  2.984688+1.164508i  3.169005+1.130256i  3.082247+1.756679i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.410267+2.322930i  2.546884+2.384884i  2.146555+2.947198i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  1.394228+3.157929i  1.443012+3.262874i  0.785990+3.604144i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.121993+3.511631i  0.082345+3.594609i -0.699071+3.606107i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.175794+3.332079i -1.266150+3.341708i -1.999920+2.995981i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.280114+2.676927i -2.360469+2.595310i -2.882805+1.954740i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.031813+1.688119i -3.042274+1.538139i -3.242563+0.736499i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -3.358084+0.547761i -3.263109+0.385193i -3.111662-0.411346i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,28]               [,29]               [,30]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  3.194756-1.284002i  2.735729-2.153526i  3.327978-1.693165i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  3.603656+0.250317i  3.607509-0.715940i  3.904522+0.039942i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.249748+1.833552i  3.686814+1.009781i  3.558030+1.867022i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.207061+3.087033i  2.931906+2.586932i  2.370007+3.306116i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.727951+3.727151i  1.532387+3.623760i  0.659922+3.994667i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.836347+3.641939i -0.153343+3.888399i -1.119520+3.795961i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.141522+2.911410i -1.711584+3.369699i -2.526342+2.829495i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.946948+1.767596i -2.798882+2.265664i -3.263255+1.417313i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.172328+0.510669i -3.237584+0.906241i -3.256870-0.032533i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -2.898129-0.588228i -3.050996-0.360514i -2.657572-1.163050i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,31]               [,32]               [,33]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  3.538295-1.816966i  2.934219-2.753455i  3.670944-2.115247i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.117047+0.055298i  4.058314-1.041023i  4.365312-0.069028i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.689469+1.987861i  4.165548+1.033839i  3.917670+2.061036i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.374734+3.458225i  3.217505+2.888765i  2.461372+3.666161i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.547336+4.092702i  1.493144+4.016301i  0.433975+4.311179i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.288299+3.777277i -0.507165+4.142719i -1.571502+3.869478i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.661483+2.679913i -2.228444+3.305879i -3.003679+2.551636i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.280741+1.179134i -3.240586+1.827172i -3.529727+0.819780i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.111968-0.273671i -3.368700+0.189753i -3.131241-0.780212i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -2.364825-1.308155i -2.730636-1.132129i -2.087600-1.807926i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,34]               [,35]               [,36]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.965611-3.056993i  3.764552-2.329925i  2.974309-3.267256i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.236640-1.226895i  4.537679-0.152168i  4.344126-1.354778i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  4.381955+1.020827i  4.066222+2.121393i  4.510763+1.010574i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  3.353111+3.026725i  2.497799+3.816440i  3.421308+3.113691i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  1.466867+4.215131i  0.320956+4.453227i  1.422178+4.331290i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.704485+4.279408i -1.802302+3.899594i -0.861134+4.336142i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.526766+3.273681i -3.259847+2.403601i -2.737659+3.198320i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.513858+1.580604i -3.690619+0.495732i -3.683263+1.349008i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.480954-0.231749i -3.093679-1.203411i -3.510422-0.579301i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -2.588606-1.611754i -1.808135-2.200601i -2.416325-1.978550i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,37]               [,38]               [,39]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  3.798810-2.473513i  3.724037-2.513883i  2.848142-3.398436i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.621881-0.215485i  4.593621-0.258521i  4.309911-1.472421i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  4.134953+2.143720i  4.135856+2.129534i  4.524998+0.956553i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.496678+3.886480i  2.493351+3.913440i  3.419847+3.131641i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.230791+4.504935i  0.188893+4.559479i  1.349867+4.383014i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.954305+3.866129i -2.053598+3.912620i -1.022831+4.351327i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -3.406932+2.246944i -3.555521+2.241122i -2.956120+3.103929i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.750009+0.227274i -3.911514+0.134801i -3.880315+1.103238i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.998964-1.520057i -3.118878-1.706887i -3.587958-0.961678i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.538640-2.467145i -1.563097-2.721363i -2.293884-2.420657i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,40]               [,41]               [,42]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  3.682801-2.563956i  2.761570-3.430926i  2.697829-3.360208i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.563475-0.297433i  4.235487-1.521588i  4.158175-1.479183i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  4.101147+2.098021i  4.462800+0.894427i  4.382802+0.911625i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.445656+3.873001i  3.369932+3.055101i  3.292628+3.053890i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.133827+4.488705i  1.315826+4.287090i  1.240975+4.273121i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -2.094939+3.796046i -1.031700+4.231962i -1.107057+4.205824i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -3.551934+2.079863i -2.925521+2.963748i -3.002280+2.919921i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.832961-0.047638i -3.795239+0.956323i -3.867757+0.885937i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.950238-1.866969i -3.439861-1.088674i -3.494274-1.191987i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.315225-2.806777i -2.088403-2.492942i -2.105344-2.626559i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,43]               [,44]               [,45]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  3.489998-2.533437i  2.544442-3.344707i  2.503186-3.229119i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.373260-0.337653i  3.999378-1.533148i  3.914323-1.445536i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.939676+1.997272i  4.253737+0.790287i  4.142331+0.835162i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.329856+3.728654i  3.223722+2.883119i  3.107003+2.881525i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.070795+4.318305i  1.249994+4.082233i  1.146548+4.040833i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -2.104604+3.613561i -1.018983+4.028036i -1.097538+3.959845i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -3.508982+1.895458i -2.849549+2.784562i -2.899753+2.703242i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.735945-0.223783i -3.675160+0.813057i -3.699316+0.728243i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.796441-2.019388i -3.290509-1.193423i -3.292327-1.277585i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.106341-2.912142i -1.917747-2.557699i -1.898682-2.640454i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,46]               [,47]               [,48]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  3.226760-2.454310i  3.169367-2.326449i  2.251673-3.068187i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  4.095778-0.388797i  3.986872-0.299655i  3.603669-1.427527i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.714051+1.825753i  3.578410+1.857750i  3.854604+0.697870i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.206766+3.477844i  2.074149+3.449958i  2.918886+2.621414i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.071337+4.046812i -0.032627+3.971541i  1.105329+3.725226i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.992502+3.378663i -2.053443+3.277997i -0.988257+3.668756i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -3.322443+1.736509i -3.339503+1.633375i -2.678563+2.503237i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.521531-0.293260i -3.504224-0.382475i -3.430613+0.652897i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.594394-2.009003i -2.556222-2.077813i -3.042754-1.233386i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.940981-2.844575i -0.893167-2.894978i -1.716411-2.512130i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,49]               [,50]               [,51]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.237927-2.919033i  2.854293-2.238266i  2.811436-2.087488i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  3.520052-1.300099i  3.658742-0.384445i  3.547272-0.271469i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.720927+0.771894i  3.330567+1.615857i  3.179146+1.661692i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.768215+2.625772i  1.977511+3.114808i  1.825761+3.084307i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.973497+3.663770i  0.046776+3.634729i -0.067924+3.541554i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.074158+3.563021i -1.826750+3.027951i -1.881613+2.902669i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.707935+2.383616i -3.035412+1.526296i -3.028294+1.404352i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.410204+0.547418i -3.207284-0.337877i -3.154379-0.428676i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.991027-1.307767i -2.336980-1.917233i -2.264259-1.964661i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.654695-2.552640i -0.788129-2.680932i -0.720752-2.689574i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,52]               [,53]               [,54]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.938316-2.766081i  1.942671-2.610790i  2.455555-2.047086i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  3.170640-1.324235i  3.096598-1.183902i  3.209461-0.427174i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  3.423211+0.566649i  3.289256+0.653420i  2.962490+1.345362i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.611827+2.291674i  2.454450+2.302119i  1.799235+2.695628i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  1.005772+3.294543i  0.867536+3.229753i  0.104808+3.193390i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.865160+3.262464i -0.950484+3.146417i -1.564002+2.692705i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.388026+2.229739i -2.406458+2.099327i -2.662329+1.381653i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.073555+0.567745i -3.033355+0.458732i -2.843050-0.276524i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.726644-1.140442i -2.652342-1.205249i -2.082931-1.701390i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.518612-2.305219i -1.440279-2.321607i -0.696280-2.404356i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,55]               [,56]               [,57]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  2.426996-1.895702i  1.592471-2.502335i  1.609988-2.357187i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  3.108125-0.308082i  2.727467-1.278737i  2.668412-1.141278i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  2.815939+1.398541i  3.012857+0.370372i  2.892216+0.460527i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.649071+2.669915i  2.359578+1.907206i  2.212201+1.924525i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.008056+3.101250i  0.987215+2.838708i  0.855896+2.781737i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.613890+2.566391i -0.652988+2.873831i -0.733497+2.765193i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.646287+1.260082i -2.023314+2.017542i -2.038118+1.893921i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.778956-0.361787i -2.676922+0.575364i -2.633772+0.473282i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.000647-1.735642i -2.416248-0.944065i -2.340002-1.000366i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.626009-2.392458i -1.371435-2.007816i -1.293690-2.012903i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,58]               [,59]               [,60]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.629183-2.210877i  2.022340-1.777820i  2.009405-1.637401i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.609423-1.001704i  2.690005-0.424996i  2.605822-0.308221i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  2.769437+0.552403i  2.514161+1.070839i  2.382233+1.128660i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.061019+1.941636i  1.561589+2.228057i  1.421779+2.210797i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.720739+2.721754i  0.145124+2.682753i  0.038409+2.600023i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.815865+2.651068i -1.275537+2.297369i -1.322433+2.179377i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.051277+1.763774i -2.235457+1.209886i -2.217865+1.094685i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.585019+0.365679i -2.421931-0.199463i -2.356073-0.279458i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -2.255051-1.059166i -1.794881-1.433555i -1.710317-1.461404i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.206190-2.016152i -0.611414-2.060908i -0.540070-2.039428i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,61]               [,62]               [,63]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.996156-1.496854i  1.267856-2.040293i  1.296761-1.914594i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.520611-0.191364i  2.199101-1.049877i  2.158029-0.923465i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  2.248484+1.185794i  2.435531+0.284459i  2.333826+0.373083i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.279996+2.191468i  1.914753+1.527385i  1.783154+1.550662i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.069364+2.513838i  0.813234+2.290161i  0.692521+2.243515i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.368515+2.057193i -0.516734+2.337111i -0.592209+2.239779i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -2.197088+0.975600i -1.645396+1.656739i -1.659362+1.542342i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.284801-0.361838i -2.199104+0.481795i -2.156445+0.385539i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -1.619007-1.489116i -1.998991-0.774826i -1.921948-0.827358i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.462190-2.014845i -1.140228-1.666683i -1.059948-1.667070i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,64]               [,65]               [,66]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.324376-1.789540i  1.597959-1.482220i  1.598804-1.362446i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.115849-0.798002i  2.161342-0.398767i  2.098159-0.293237i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  2.231046+0.460349i  2.046853+0.805644i  1.937545+0.863128i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.650663+1.571937i  1.309189+1.754364i  1.188676+1.746668i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.571553+2.194255i  0.182694+2.159247i  0.087918+2.092793i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.666875+2.139590i -0.978050+1.891615i -1.022159+1.791397i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.671224+1.425348i -1.791681+1.036845i -1.778745+0.935720i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -2.110354+0.287504i -1.982647-0.109481i -1.924722-0.181626i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -1.840437-0.880267i -1.497649-1.137616i -1.420290-1.162994i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.974894-1.666015i -0.536750-1.681199i -0.469898-1.659747i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,67]               [,68]               [,69]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.597957-1.243923i  0.939827-1.710537i  0.975551-1.610343i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  2.033836-0.189444i  1.732582-0.939411i  1.709766-0.831899i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  1.827663+0.918463i  1.971169+0.122556i  1.893863+0.203267i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.068315+1.736573i  1.608202+1.135497i  1.501228+1.163329i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.005889+2.024043i  0.765406+1.799312i  0.663398+1.768282i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -1.064556+1.689305i -0.302093+1.909085i -0.369505+1.833377i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.763421+0.833343i -1.252784+1.419909i -1.270004+1.326031i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -1.863810-0.254181i -1.762565+0.493224i -1.730887+0.410774i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -1.339606-1.187701i -1.657184-0.540475i -1.593459-0.587828i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.399889-1.636475i -0.993134-1.306389i -0.923888-1.308706i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     [,70]               [,71]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.008965-1.511158i  1.039697-1.412965i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  1.685370-0.726095i  1.659075-0.622258i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  1.815788+0.281827i  1.736821+0.357800i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  1.394374+1.188810i  1.287795+1.211506i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.562361+1.735110i  0.462695+1.699542i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.435365+1.756065i -0.499170+1.677184i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.285348+1.231165i -1.298391+1.135631i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -1.697094+0.327955i -1.660991+0.245266i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -1.527436-0.634868i -1.459237-0.681086i</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.852336-1.309989i -0.778902-1.309900i</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># power</span></span>
<span class="r-in"><span class="va">power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html" class="external-link">Mod</a></span><span class="op">(</span><span class="va">coef</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Power peaks at 5Hz and 10Hz at early stages</span></span>
<span class="r-in"><span class="co"># After 1.0 second, 5Hz component fade away</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">power</span>, x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">freq</span>, ylab <span class="op">=</span> <span class="st">"frequency"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># wavelet using double precision</span></span>
<span class="r-in"><span class="va">coef2</span> <span class="op">&lt;-</span> <span class="fu">morlet_wavelet</span><span class="op">(</span><span class="va">x</span>, <span class="va">freq</span>, <span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, precision <span class="op">=</span> <span class="st">"double"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">power2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">coef2</span><span class="op">$</span><span class="va">real</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">coef2</span><span class="op">$</span><span class="va">imag</span><span class="op">[</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">power2</span>, x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="va">freq</span>, ylab <span class="op">=</span> <span class="st">"frequency"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="wavelet-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># The maximum relative change of power with different precisions</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">power</span><span class="op">/</span><span class="va">power2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.914835e-05</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># display kernels</span></span>
<span class="r-in"><span class="va">freq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">kern</span> <span class="op">&lt;-</span> <span class="fu">wavelet_kernels</span><span class="op">(</span><span class="va">freq</span>, <span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">kern</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Discrete wavelet kernels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of kernels/frequencies: 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   frequency range: 1.00 Hz - 15.00 Hz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   number of cycles: 2.00 - 3.00</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kern</span><span class="op">)</span></span>
<span class="r-plt img"><img src="wavelet-3.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Zhengjia Wang.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

