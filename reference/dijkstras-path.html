<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate surface distances of graph or mesh using 'Dijkstra' method."><title>Calculate distances along a surface — dijkstras-path • ravetools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate distances along a surface — dijkstras-path"><meta property="og:description" content="Calculate surface distances of graph or mesh using 'Dijkstra' method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ravetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dipterix/ravetools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate distances along a surface</h1>
      <small class="dont-index">Source: <a href="https://github.com/dipterix/ravetools/blob/HEAD/R/dijkstras-path.R" class="external-link"><code>R/dijkstras-path.R</code></a></small>
      <div class="d-none name"><code>dijkstras-path.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate surface distances of graph or mesh using 'Dijkstra' method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dijkstras_surface_distance</span><span class="op">(</span></span>
<span>  <span class="va">start_node</span>,</span>
<span>  <span class="va">positions</span>,</span>
<span>  <span class="va">faces</span>,</span>
<span>  face_index_start <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max_search_distance <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  max_edge_length <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">surface_path</span><span class="op">(</span><span class="va">x</span>, <span class="va">target_node</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>start_node</dt>
<dd><p>integer, row index of <code>positions</code> on where to start
calculating the distances. This integer must be 1-indexed and cannot exceed
the total number of <code>positions</code> rows</p></dd>


<dt>positions</dt>
<dd><p>numeric matrix with no <code>NA</code> values. The number of row
is the total count of nodes (vertices), and the number of columns represent
the node dimension. Each row represents a node.</p></dd>


<dt>faces</dt>
<dd><p>integer matrix with each row containing indices of nodes. For
graphs, <code>faces</code> is a matrix with two columns defining the connecting
edges; for '3D' mesh, <code>faces</code> is a three-column matrix defining the
face index of mesh triangles.</p></dd>


<dt>face_index_start</dt>
<dd><p>integer, the start of the nodes in <code>faces</code>;
please specify this input explicitly if the first node is not contained
in <code>faces</code>.
Default is <code>NA</code> (determined by the minimal number in <code>faces</code>).
The reason to set this input is because some programs use <code>1</code> to
represent the first node, some start from <code>0</code>.</p></dd>


<dt>max_search_distance</dt>
<dd><p>numeric, maximum distance to iterate;
default is <code>NA</code>,
that is to iterate and search the whole mesh</p></dd>


<dt>max_edge_length</dt>
<dd><p>numeric, maximum edge length to consider;
default is <code>NA</code>,
that is to consider all edges. In triangular mesh objects, it is possible
that some edges are too long to consider as "valid" path. User this input
to ignore those edges.</p></dd>


<dt>verbose</dt>
<dd><p>whether to verbose the progress; default is false</p></dd>


<dt>x</dt>
<dd><p>distance calculation results returned by
<code>dijkstras_surface_distance</code> function</p></dd>


<dt>target_node</dt>
<dd><p>the target node number to reach (from the starting node);
<code>target_node</code> is always 1-indexed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>dijkstras_surface_distance</code> returns a list distance
table with the meta configurations. <code>surface_path</code> returns a data frame
of the node ID (from <code>start_node</code> to <code>target_node</code>) and cumulative
distance along the shortest path.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---- Toy example --------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Position is 2D, total 6 points</span></span></span>
<span class="r-in"><span><span class="va">positions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">6</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># edges defines connected nodes</span></span></span>
<span class="r-in"><span><span class="va">edges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">2</span>,</span></span>
<span class="r-in"><span>  <span class="fl">2</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>  <span class="fl">1</span>,<span class="fl">3</span>,</span></span>
<span class="r-in"><span>  <span class="fl">2</span>,<span class="fl">4</span>,</span></span>
<span class="r-in"><span>  <span class="fl">3</span>,<span class="fl">4</span>,</span></span>
<span class="r-in"><span>  <span class="fl">2</span>,<span class="fl">5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">4</span>,<span class="fl">5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">2</span>,<span class="fl">5</span>,</span></span>
<span class="r-in"><span>  <span class="fl">4</span>,<span class="fl">6</span>,</span></span>
<span class="r-in"><span>  <span class="fl">5</span>,<span class="fl">6</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># calculate distances</span></span></span>
<span class="r-in"><span><span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu">dijkstras_surface_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>  start_node <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  positions <span class="op">=</span> <span class="va">positions</span>,</span></span>
<span class="r-in"><span>  faces <span class="op">=</span> <span class="va">edges</span>,</span></span>
<span class="r-in"><span>  face_index_start <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># get shortest path from the first node to the last</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu">surface_path</span><span class="op">(</span><span class="va">ret</span>, target_node <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the results</span></span></span>
<span class="r-in"><span><span class="va">from_node</span> <span class="op">&lt;-</span> <span class="va">path</span><span class="op">$</span><span class="va">path</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">to_node</span> <span class="op">&lt;-</span> <span class="va">path</span><span class="op">$</span><span class="va">path</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">positions</span>, pch <span class="op">=</span> <span class="fl">16</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">"X"</span>, ylab <span class="op">=</span> <span class="st">"Y"</span>, main <span class="op">=</span> <span class="st">"Dijkstra's shortest path"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x0 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">edges</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fl">1</span><span class="op">]</span>, y0 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">edges</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">edges</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">1</span><span class="op">]</span>, y1 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">edges</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">positions</span><span class="op">[</span><span class="va">path</span><span class="op">$</span><span class="va">path</span>,<span class="op">]</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x0 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">from_node</span>,<span class="fl">1</span><span class="op">]</span>, y0 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">from_node</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">to_node</span>,<span class="fl">1</span><span class="op">]</span>, y1 <span class="op">=</span> <span class="va">positions</span><span class="op">[</span><span class="va">to_node</span>,<span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">0.1</span>, lty <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">positions</span><span class="op">[</span><span class="fl">1</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"orangered"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">positions</span><span class="op">[</span><span class="fl">6</span>,,drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"purple3"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dijkstras-path-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ---- Example with mesh ------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">read.fs.surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="internal_rave_function.html">internal_rave_function</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"read.fs.surface"</span>, <span class="st">"threeBrain"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/is.function.html" class="external-link">is.function</a></span><span class="op">(</span><span class="va">read.fs.surface</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Please install package `threeBrain`. and library(threeBrain)</span></span></span>
<span class="r-in"><span>  <span class="co"># the following code set up the files</span></span></span>
<span class="r-in"><span>  <span class="va">read.fs.surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="internal_rave_function.html">internal_rave_function</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"read.fs.surface"</span>, <span class="st">"threeBrain"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">default_template_directory</span> <span class="op">&lt;-</span> <span class="fu"><a href="internal_rave_function.html">internal_rave_function</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"default_template_directory"</span>, <span class="st">"threeBrain"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">surface_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu">default_template_directory</span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                            <span class="st">"N27"</span>, <span class="st">"surf"</span>, <span class="st">"lh.pial"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="va">surface_path</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="internal_rave_function.html">internal_rave_function</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="st">"download_N27"</span>, <span class="st">"threeBrain"</span><span class="op">)</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Example starts from here ---&gt;</span></span></span>
<span class="r-in"><span>  <span class="co"># Load the mesh</span></span></span>
<span class="r-in"><span>  <span class="va">mesh</span> <span class="op">&lt;-</span> <span class="fu">read.fs.surface</span><span class="op">(</span><span class="va">surface_path</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Calculate the path with maximum radius 100</span></span></span>
<span class="r-in"><span>  <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu">dijkstras_surface_distance</span><span class="op">(</span></span></span>
<span class="r-in"><span>    start_node <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    positions <span class="op">=</span> <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span>,</span></span>
<span class="r-in"><span>    faces <span class="op">=</span> <span class="va">mesh</span><span class="op">$</span><span class="va">faces</span>,</span></span>
<span class="r-in"><span>    max_search_distance <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>    verbose <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># get shortest path from the first node to node 43144</span></span></span>
<span class="r-in"><span>  <span class="va">path</span> <span class="op">&lt;-</span> <span class="fu">surface_path</span><span class="op">(</span><span class="va">ret</span>, target_node <span class="op">=</span> <span class="fl">43144</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># plot</span></span></span>
<span class="r-in"><span>  <span class="va">from_nodes</span> <span class="op">&lt;-</span> <span class="va">path</span><span class="op">$</span><span class="va">path</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">to_nodes</span> <span class="op">&lt;-</span> <span class="va">path</span><span class="op">$</span><span class="va">path</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="co"># calculate colors</span></span></span>
<span class="r-in"><span>  <span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html" class="external-link">colorRampPalette</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"orange"</span>, <span class="st">"orange3"</span>, <span class="st">"purple3"</span>, <span class="st">"purple4"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">(</span><span class="fl">1001</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">col</span> <span class="op">&lt;-</span> <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">path</span><span class="op">$</span><span class="va">distance</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">path</span><span class="op">$</span><span class="va">distance</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span><span class="op">(</span><span class="va">xdim</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span> <span class="va">xdim</span> <span class="op">&lt;</span> <span class="fl">3</span> <span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">ydim</span> <span class="op">&lt;-</span> <span class="va">xdim</span> <span class="op">+</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">ydim</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>      <span class="va">xdim</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span>, <span class="va">xdim</span><span class="op">]</span>, <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span>, <span class="va">ydim</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      pch <span class="op">=</span> <span class="st">"."</span>, col <span class="op">=</span> <span class="st">"#BEBEBE33"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>      xlab <span class="op">=</span> <span class="st">"P - A"</span>, ylab <span class="op">=</span> <span class="st">"S - I"</span>, asp <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      x0 <span class="op">=</span> <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span><span class="va">from_nodes</span>, <span class="va">xdim</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      y0 <span class="op">=</span> <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span><span class="va">from_nodes</span>, <span class="va">ydim</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      x1 <span class="op">=</span> <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span><span class="va">to_nodes</span>, <span class="va">xdim</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      y1 <span class="op">=</span> <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span><span class="va">to_nodes</span>, <span class="va">ydim</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      col <span class="op">=</span> <span class="va">col</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># plot distance map</span></span></span>
<span class="r-in"><span>  <span class="va">distances</span> <span class="op">&lt;-</span> <span class="va">ret</span><span class="op">$</span><span class="va">paths</span><span class="op">$</span><span class="va">distance</span></span></span>
<span class="r-in"><span>  <span class="va">col</span> <span class="op">&lt;-</span> <span class="va">pal</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">distances</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">distances</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">selection</span> <span class="op">&lt;-</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">distances</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="st">"."</span>, col <span class="op">=</span> <span class="st">"#BEBEBE33"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    xlab <span class="op">=</span> <span class="st">"P - A"</span>, ylab <span class="op">=</span> <span class="st">"S - I"</span>, asp <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">mesh</span><span class="op">$</span><span class="va">vertices</span><span class="op">[</span><span class="va">selection</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">col</span><span class="op">[</span><span class="va">selection</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    pch <span class="op">=</span> <span class="st">"."</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># reset graphic state</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Zhengjia Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

